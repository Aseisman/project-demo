(function(){var e={379:function(e,t,i){"use strict";i.r(t)},5751:function(e,t,i){"use strict";i.r(t)},9543:function(e,t,i){"use strict";i.r(t)},3382:function(e,t,i){"use strict";i.r(t);var a=i(6369),s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"win-container"},[t("div",{class:e.bodyCls+" body"},[e._t("default")],2),t("div",{staticClass:"footer"},[e.$slots.footer?[e._t("footer")]:[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.cancel()}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.$emit("submit")}}},[e._v("确 定")])]],2)])},n=[],l=i(6414),r={mixins:[l.Z],methods:{cancel(){let e=this.getExtCt();e[e.closeAction]()}},props:{bodyCls:{type:String,default:""}}},o=r,d=i(1001),c=(0,d.Z)(o,s,n,!1,null,null,null),u=c.exports;let{Form:h}=window.ElUI.ui;var p,m,f,v,g,b,y={name:"KdForm",extends:h,methods:{isValid(){return new Promise((e=>{this.validate(((t,i)=>{if(t)e(!0);else for(let a in i){let t=this.fields.find((e=>i[a][0].field===e.prop));return SF.showTip(i[a][0].message,(()=>{Ext.each(t.$children,(e=>{if("function"===typeof e.focus)return e.focus(),!1}))})),e(!1),!1}}))}))}}},_=y,k=(0,d.Z)(_,p,m,!1,null,null,null),A=k.exports,C=function(){var e=this,t=e._self._c;return t("el-table",e._g(e._b({ref:"elTable",attrs:{data:e.data}},"el-table",e.$attrs,!1),e.$listeners),[e._l(e.tbColumns,(function(i){return[i.slotScope?t("el-table-column",e._g(e._b({key:i.prop,attrs:{newLeftFixed:i.newLeftFixed},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t(i.prop,null,null,t)]}}],null,!0)},"el-table-column",i,!1),e.$listeners)):t("free-column",e._b({key:i.prop,attrs:{column:i}},"free-column",e.$attrs,!1))]}))],2)},w=[],x=function(){var e=this,t=e._self._c;return t("el-table-column",e._g(e._b({scopedSlots:e._u([{key:"header",fn:function(i){return[t("div",{staticClass:"cell-container"},[e.column._renderHeader?t("free-render",{attrs:{scope:i,render:e.column._renderHeader}}):t("span",{staticClass:"cell-container-text"},[e._v(e._s(i.column.label))]),e.column.searchable?t("el-popover",{staticClass:"search-cmp-container",attrs:{placement:"bottom",trigger:"click","popper-class":"popper-container"},on:{"after-leave":function(t){e.alwaysShowSearchCmp=!1}}},[t("head-render",{attrs:{scope:i,render:e.column.searchCmp}}),t("div",{class:["search-container",e.alwaysShowSearchCmp?"search-container-active":""],attrs:{slot:"reference"},on:{click:function(t){e.alwaysShowSearchCmp=!0}},slot:"reference"},[t("span")])],1):e._e()],1)]}},{key:"default",fn:function(i){return[e.column.component?t(e.column.component,e._g(e._b({tag:"component"},"component",e.getCptBind(i,e.column),!1),e.column.listeners)):e.column.children?e._l(e.column.children,(function(e){return t("free-column",{key:e.prop,attrs:{column:e}})})):t("free-render",{attrs:{scope:i,render:e.column.render}})]}}])},"el-table-column",e.column,!1),e.$listeners))},S=[],T={name:"FreeRender",functional:!0,props:{scope:Object,render:Function},render:(e,t)=>t.props.render?t.props.render(e,t.props.scope):""},E=T,N=(0,d.Z)(E,f,v,!1,null,null,null),F=N.exports,P={name:"HeadRender",functional:!0,props:{scope:Object,render:Function},render:(e,t)=>t.props.render?t.props.render(e,t):""},D=P,B=(0,d.Z)(D,g,b,!1,null,null,null),R=B.exports,z=(i(7658),{selection:{renderHeader:function(e,{store:t}){return e("el-checkbox",{attrs:{disabled:t.states.data&&0===t.states.data.length,indeterminate:t.states.selection.length>0&&!this.isAllSelected,value:this.isAllSelected},nativeOn:{click:this.toggleAllSelection}})},renderCell:function(e,{row:t,column:i,store:a,$index:s}){return e("el-checkbox",{nativeOn:{click:e=>e.stopPropagation()},attrs:{value:a.isSelected(t),disabled:!!i.selectable&&!i.selectable.call(null,t,s)},on:{input:()=>{a.commit("rowSelectedChanged",t)}}})},sortable:!1,resizable:!1},index:{renderHeader:function(e,{column:t}){return t.label||"#"},renderCell:function(e,{$index:t,column:i}){let a=t+1;const s=i.index;return"number"===typeof s?a=t+s:"function"===typeof s&&(a=s(t)),e("div",[a])},sortable:!1},expand:{renderHeader:function(e,{column:t}){return t.label||""},renderCell:function(e,{row:t,store:i}){const a=["el-table__expand-icon"];i.states.expandRows.indexOf(t)>-1&&a.push("el-table__expand-icon--expanded");const s=function(e){e.stopPropagation(),i.toggleRowExpansion(t)};return e("div",{class:a,on:{click:s}},[e("i",{class:"el-icon el-icon-arrow-right"})])},sortable:!1,resizable:!1,className:"el-table__expand-column"}}),O={name:"FreeColumn",props:{column:{type:Object,default:()=>{}}},data(){return{showSearchCmp:!1,alwaysShowSearchCmp:!1}},components:{FreeRender:F,HeadRender:R},watch:{column:{handler:"renderColumn",immediate:!0}},methods:{renderColumn(){this.$createElement;const{column:e}=this;return e.type&&(e._renderHeader=z[e.type]._renderHeader,e.render=e.render||z[e.type].renderCell),e.formatter&&(e.render=(e,t)=>e("span",[t.column.formatter(t.row,t.column,t.row[t.column.property],t.$index)])),e.render||(e.render=(e,t)=>e("span",[t.row[t.column.property]])),e},getColBind(e){const t=Object.assign({},this.$attrs,e);return delete t.component,delete t.listeners,delete t.propsHandler,t},getCptBind({row:e,column:t},i){const a={row:e,col:i,column:t},s=i.propsHandler;return s&&s(a)||a}}},G=O,Y=(0,d.Z)(G,x,S,!1,null,"78104aca",null),I=Y.exports,M={components:{FreeColumn:I},props:{data:Array,columns:Array,columnsProps:Object},computed:{tbColumns(){const{columns:e,columnsProps:t}=this;return e.map((e=>{const i=Object.assign({},t,e);return i}))}}},Z=M,$=(0,d.Z)(Z,C,w,!1,null,null,null),V=$.exports,j=function(){var e=this,t=e._self._c;return t("div",{staticClass:"card-panel-container"},[e._t("default")],2)},H=[],U={componentName:"cardPanel",props:{activeName:String,value:{}},data(){return{currentName:this.value||this.activeName,preName:null}},watch:{activeName(e){this.setCurrentName(e)},value(e){this.setCurrentName(e)},currentName(e,t){this.preName=t}},mounted(){this.$on("back",this.back)},methods:{back(){this.preName&&this.setCurrentName(this.preName)},setCurrentName(e){this.currentName=e,this.$emit("input",e)}}},W=U,q=(0,d.Z)(W,j,H,!1,null,null,null),L=q.exports,Q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"right-panel-container"},[t("div",{staticClass:"header"},[t("span",{staticClass:"title"},[e._v(e._s(e.title))]),t("div",{staticClass:"right"},[e._t("headerRight"),t("i",{staticClass:"el-icon-close",on:{click:function(t){return e.hide()}}})],2)]),t("div",{staticClass:"body"},[e._t("default")],2)])},J=[],X={mixins:[l.Z],props:{title:String},methods:{hide(){let e=this.getExtCt();e.hideRightItem()}}},K=X,ee=(0,d.Z)(K,Q,J,!1,null,null,null),te=ee.exports,ie=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-panel-container"},[t("div",{staticClass:"header draggable-title"},[t("span",{staticClass:"title"},[e._v(e._s(e.title)+" "),e.showReturn?t("span",{on:{click:e.back}},[t("i",{staticClass:"el-icon-arrow-left"}),e._v(" 返回 ")]):e._e()]),t("div",{staticClass:"right"},[e._t("headerRight")],2)]),t("div",{staticClass:"body",class:this.flexCls},[e._t("default")],2)])},ae=[];let{Emitter:se}=window.ElUI.utils;var ne={mixins:[se],props:{title:String,showReturn:Boolean,flexType:String},computed:{flexCls(){return this.flexType?this.flexType+"-flex":""}},methods:{back(){this.dispatch("cardPanel","back")}}},le=ne,re=(0,d.Z)(le,ie,ae,!1,null,null,null),oe=re.exports,de=function(){var e=this,t=e._self._c;return t("div")},ce=[];let{Emitter:ue}=window.ElUI.utils;var he={props:{maxNum:{type:Number,default:9},value:Array,disabled:Boolean},mixins:[ue],watch:{value(e){this.dispatch("ElFormItem","el.form.change",e)}},mounted(){this.cmp=new SFX.upload.PicUploader({renderTo:this.$el,maxNum:this.maxNum}),this.cmp.setJsonValue(this.value)},destroyed(){this.cmp&&this.cmp.destroy()}},pe=he,me=(0,d.Z)(pe,de,ce,!1,null,null,null),fe=me.exports,ve=function(){var e=this,t=e._self._c;return t("div")},ge=[];let{Emitter:be}=window.ElUI.utils;var ye={props:{maxNum:{type:Number,default:9},value:Array,disabled:Boolean},mixins:[be],watch:{value(e){this.dispatch("ElFormItem","el.form.change",e)}},mounted(){this.cmp=new SFX.upload.AttachField({cls:" fileuploader-for-vue ",renderTo:this.$el,maxAttachNum:this.maxNum}),this.cmp.setJsonValue(this.value)},destroyed(){this.cmp&&this.cmp.destroy()}},_e=ye,ke=(0,d.Z)(_e,ve,ge,!1,null,null,null),Ae=ke.exports;i(8115),i(379),i(5751),i(9543),a["default"].component("win-panel",u),a["default"].component("kd-form",A),a["default"].component("kd-table",V),a["default"].component("card-panel",L),a["default"].component("right-panel",te),a["default"].component("main-panel",oe),a["default"].component("pic-uploader",fe),a["default"].component("file-uploader",Ae)},6414:function(e,t){"use strict";t["Z"]={methods:{getExtCt(){var e=this.$parent||this.$root;while(e){if(e.$extCt)return e.$extCt;e=e.$parent}return null},createWin(e,t,i,a=!1){},setVueData(e,t){const i=this._wins,a=i[e].view;Vue.nextTick((()=>{const e=a.$children;if(!e.length)return console.error("vue实例没有$children");1==e.length?Object.keys(t).forEach((i=>{e[0][i]=t[i]})):e.length>1&&(console.warn("$children有多个实例,默认传入第一个"),Object.keys(t).forEach((i=>{e[0][i]=t[i]})))}))},setVueEmits(e,t){const i=this._wins,a=i[e].view;Vue.nextTick((()=>{const e=a.$children;if(!e.length)return console.error("vue实例没有$children");Object.keys(t).forEach((i=>{e[0].$on(i,t[i])}))}))},getWin(e){if(this._wins?.[e])return this._wins[e];this.$message("获取窗口失败：名称为【"+e+"】的窗口不存在")},showWin(e){var t=this.getWin(e);return t.show(),t},createRightItem(e,t,i){},getRightItem(e){if(this._rightItems?.[e])return this._rightItems[e];this.$message("获取窗口失败：名称为【"+e+"】的窗口不存在")},showRightItem(e){var t=this.getRightItem(e);return t.showRightItem(),t},hideRightItem(e){var t=this.getRightItem(e);return t.hideRightItem(),t}},destroyed(){Object.keys(this._wins).forEach((e=>{let t=this._wins[e];t.destroy()})),this._wins=null,this._rightItems=null}}},8115:function(){let{PopupManager:e}=window.ElUI.utils;e.nextZIndex=function(){let t=1e3;return e.zIndex<t&&(e.zIndex=t),e.zIndex++}},722:function(e,t,i){"use strict";var a=i(6369),s=function(){var e=this,t=e._self._c;return t("main-panel",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"sale-panel",attrs:{title:e.title,flexType:"column"},scopedSlots:e._u([{key:"headerRight",fn:function(){return[1==e.type?t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.addSales}},[e._v("新建商机")]):e._e(),e.exportPermit?t("el-button",{attrs:{type:2==e.exportPermit?"info":"primary",size:"small"},on:{click:e.exportSales}},[e._v("导出商机")]):e._e()]},proxy:!0}])},[t("CommonGrid",{ref:"commongrid",attrs:{total:e.total,tableData:e.tableData,rowToolBtns:e.rowToolBtns,allToolBtns:e.allToolBtns,hasPermitShow:!0,columns:e.columns,filter:e.hdFilter,pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t},"header-dragend":e.handleHeaderDragend,deleteFilter:t=>{e.deletehdFilter(t),this.updateGrid()}},scopedSlots:e._u([{key:"toolRight",fn:function(){return[t("el-button",{attrs:{type:"small"},on:{click:function(t){return e.openFilterColumnsWin()}}},[e._v("列表")])]},proxy:!0}])}),t("el-dialog",{attrs:{title:"自定义列表显示",visible:e.dialogVisible,width:"450px",top:"0"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("FilterColumnWin",{attrs:{originData:e.displaySetting},on:{save:e.onFliterSave}})],1)],1)},n=[],l=(i(7658),i(6414)),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"body-cls"},[t("div",{ref:"filterRef",staticClass:"filter-container filter-label"},e._l(e.filter,(function(i){return t("div",{key:i.key,staticClass:"item"},[t("label",[e._v(e._s(i.label+":"))]),t("span",{staticClass:"value"},[e._v(e._s(i.valueText?i.valueText:i.value))]),t("span",{staticClass:"close",on:{click:function(t){return e.deleteFilter(i.key)}}})])})),0),t("div",{staticClass:"gridToolbar"},[e.hasPermitShow?[e.rowChecked&&!e.allChecked?t("div",{staticClass:"rowChecked"},[t("div",[e._v("已选择 "+e._s(e.rowChecked)+" 条")]),t("div",{staticClass:"toolBtn"},e._l(e.rowToolBtns,(function(i){return t("div",{key:i.action,staticClass:"x-btn",on:{click:function(t){return e.handleBtnEmit(i.action)}}},[t("div",{style:`background-image:url(${i.icon})`}),t("div",[e._v(e._s(i.name))])])})),0)]):t("div",{staticClass:"totalChecked"},[t("div",[t("span",[e._v(e._s(e.allChecked?"已选":"共")+" "+e._s(e.total)+" 条数据")]),e.showAllChecked?t("span",[e._v("|")]):e._e(),e.showAllChecked?t("span",{staticClass:"all",on:{click:e.handleCheckAll}},[e._v(e._s(e.allChecked?"取消全选":"全选列表"))]):e._e()]),e.allChecked?t("div",{staticClass:"toolBtn"},e._l(e.allToolBtns,(function(i){return t("div",{key:i.action,staticClass:"x-btn",on:{click:function(t){return e.handleBtnEmit(i.action)}}},[t("div",{style:`background-image:url(${i.icon})`}),t("div",[e._v(e._s(i.name))])])})),0):e._e()])]:[t("div")],t("div",{staticClass:"toolRight"},[e._t("toolRight")],2)],2),t("div",{staticClass:"flex-grid-panel"},[t("kd-table",e._g(e._b({ref:"kdTable",class:e.isChrome?"kdTable isChrome":"kdTable",attrs:{border:"","header-cell-style":e.headerStyle,"header-cell-class-name":e.headCellClassName,"cell-class-name":e.cellClassName,data:e.tableData,columns:e.columns,height:"100%"},on:{"select-all":e.AutoCheckAll,select:e.handleCheckOne}},"kd-table",e.$attrs,!1),e.$listeners))],1),t("el-pagination",{staticClass:"kdPagination",attrs:{background:"","current-page":e.spagination.start,"page-sizes":[20,50,100,200],"page-size":e.spagination.limit,layout:"total,->,sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.spagination,"start",t)},"update:current-page":function(t){return e.$set(e.spagination,"start",t)},"update:pageSize":function(t){return e.$set(e.spagination,"limit",t)},"update:page-size":function(t){return e.$set(e.spagination,"limit",t)}}})],1)},o=[],d=i(4806),c={props:{hasPermitShow:{type:Boolean,default:!0},total:{type:Number,default:0},allToolBtns:{type:Array,default:()=>[]},rowToolBtns:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},tableData:{type:Array,default:()=>[]},filter:{type:Array,default:()=>[]},pagination:{type:Object,default:()=>({start:0,limit:50})},showAllChecked:{type:Boolean,default:!0}},data(){return{rowChecked:0,allChecked:!1,headerStyle:{background:"#F7F7FA",color:"92929D",padding:"8px 0px",borderColor:"#E2E2EA"},spagination:{start:0,limit:50},isChrome:!0}},watch:{total(e){return 0==e&&(this.allChecked=!1),e},columns:{handler:function(){console.log("watch columns");let e=this.columns.length,t=this.$refs.kdTable.$el.offsetWidth;if(!e)return;if(this.hasPermitShow&&!this.columns[0].type)return void this.columns.unshift({type:"selection",newLeftFixed:!0,width:40,selectable:this.selectableFn});this.hasPermitShow&&(e-=1,t-=40);const i=this.columns.reduce(((e,t,i)=>this.hasPermitShow&&0==i?e:e+Number(t.width)),0)+1;if(i<t){const a=Math.floor((t-i)/e),s=t-i-a*e;this.columns.forEach(((e,t)=>{this.hasPermitShow&&0==t||(e.width+=a,1==t&&(e.width+=s))}))}this.resizeTable()}},hasPermitShow(e){console.log("watch hasPermitShow"),e&&!this.columns[0]?.type&&this.columns.unshift({type:"selection",fixed:!0,width:"40",selectable:this.selectableFn})},pagination(e){this.spagination=e}},mounted(){this.isChrome=window.navigator.userAgent.indexOf("Chrome")>=0,window.addEventListener("resize",this.resizeColumn)},methods:{AutoCheckAll(e){this.rowChecked=e.length},handleCheckOne(e){this.rowChecked=e.length},handleCheckAll(){0!=this.total&&(this.allChecked=!this.allChecked,this.allChecked?this.$refs.kdTable.$refs.elTable.toggleAllSelection():(this.$refs.kdTable.$refs.elTable.clearSelection(),this.rowChecked=0),this.$emit("CHECK_ALL",this.allChecked))},handleCurrentChange(){this.$refs.kdTable.$refs.elTable.bodyWrapper.scrollTop=0,this.$emit("update:pagination",this.spagination)},handleSizeChange(){this.spagination.start=0,this.$emit("update:pagination",this.spagination)},handleBtnEmit(e){this.$emit(e,this.allChecked,this.$refs.kdTable.$refs.elTable.selection)},resizeTable:(0,d.debounce)((function(){this.$refs.kdTable.$refs.elTable.doLayout()}),600),deleteFilter(e){this.$emit("deleteFilter",e)},selectableFn(){return!this.allChecked},resetCheck(){this.rowChecked=0,this.allChecked=!1},resizeColumn:(0,d.debounce)((function(){const e=this.$refs.kdTable.$el.offsetWidth,t=this.$refs.kdTable.$children[0].columns,i=t.length;if(!i)return;const a=t.reduce(((e,t)=>e+Number(t.width)),0)+1;if(a<e){const t=Math.floor((e-a)/i),s=e-a-t*i;this.columns.forEach(((e,a)=>{0==a&&e.type?this.columns[i-1].width+=t:(e.width=Number(e.width)+t,1==a&&(e.width+=s))}))}console.log("onresize columns"),this.resizeTable()}),200)},computed:{headCellClassName(){return this.allChecked?"disableSelection":""},cellClassName(){return this.allChecked?"celldisableSelection":"cellClassName"}},destroyed(){window.removeEventListener("resize",this.resizeColumn)}},u=c,h=i(1001),p=(0,h.Z)(u,r,o,!1,null,"3a543074",null),m=p.exports,f=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"max-height":"70vh",overflow:"auto"}},[e._m(0),t("div",{staticClass:"grid-body fix-grid-body undraggable"},[e._m(1),t("div",[t("span",[e._v(e._s(e.columnData[0]?e.columnData[0].name:""))]),t("span",{staticClass:"tip-text"},[e._v(e._s("(固定在列表左侧)"))])]),t("div")]),t("draggable",{attrs:{filter:".undraggable"},model:{value:e.columnData,callback:function(t){e.columnData=t},expression:"columnData"}},[e._l(e.columnData,(function(i,a){return[a>=1?t("div",{key:i.id,staticClass:"grid-body",on:{click:function(t){return e.checkItem(a,i)}}},[t("div",[t("div",{class:e.getCheckBoxCls(i)})]),t("div",[t("span",[e._v(e._s(i.name))]),t("span",{staticClass:"tip-text"},[e._v(e._s(a>=e.fixColumn?"":"(固定在列表左侧)"))])]),t("div",{class:a>=1?"opt-list-line-icon":""})]):e._e()]}))],2)],1),t("div",{staticStyle:{"margin-top":"20px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveOptions}},[e._v("确 定")])],1)])},v=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"grid-header"},[t("div",[e._v("是否显示")]),t("div",[e._v("列名称")]),t("div",[e._v("拖动排序")])])},function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"ct-checkbox-box ct-checkbox-checked-disabled"})])}],g=i(6983),b=i.n(g),y={components:{draggable:b()},props:{originData:{type:Array,default:()=>[]},fixCount:{type:Number,default:2}},data(){return{columnData:[],fixColumn:2}},watch:{originData:{handler(e){console.log(e),this.columnData=[...e]},immediate:!0},fixCount(e){this.fixColumn=e}},methods:{saveOptions(){this.$emit("save",this.columnData)},checkItem(e,t){t.disable||(this.columnData[e].check=!this.columnData[e].check)},getCheckBoxCls(e){let t=["ct-checkbox-box"];return e.disable&&e.check?t.push("ct-checkbox-checked-disabled"):e.disable&&!e.check?t.push("ct-checkbox-disabled"):!e.disable&&e.check&&t.push("ct-checkbox-checked"),t}}},_=y,k=(0,h.Z)(_,f,v,!1,null,"be952254",null),A=k.exports,C={data(){return{hdFilter:[]}},methods:{deletehdFilter(e){const t=this.hdFilter.findIndex((t=>t.key==e));~t&&this.hdFilter.splice(t,1)},deleteSortType(){for(let e=0;e<this.hdFilter.length;e++)3!=this.hdFilter[e].type&&4!=this.hdFilter[e].type||(this.hdFilter.splice(e,1),e--)},updatehdFilter(e){const t=e=>{var t=this.hdFilter.findIndex((t=>t.key==e.key));~t?this.hdFilter.splice(t,1,{...this.hdFilter[t],...e}):(3!=e.type&&4!=e.type||this.deleteSortType(),this.hdFilter.push({...e}))};return Array.isArray(e)?e.forEach((e=>{t(e)})):t(e),Promise.resolve()},getValueText(e,t){return 0===e&&(e="0"),0===t&&(t="0"),e&&!t?e+" 以上":!e&&t?t+" 以下":e&&t?e+" 至 "+t:void 0}},computed:{filter(){const e=[],t=[],i=[];return this.hdFilter.forEach((a=>{1==a.type||4==a.type?a.value?.forEach((t=>{e.push({key:t.key,value:t.value})})):2==a.type?i.push(a.value):/^prop/.test(a.key)?t.push(a.value):e.push({key:a.key,value:a.value})})),t.length&&e.push({key:"props",value:t}),i.length&&e.push({key:"no_prop_ids",value:i}),e}}},w=function(){var e=this,t=e._self._c;return t("div",[e.sort?t("div",{staticClass:"btn-panel"},[t("el-button",{attrs:{size:"small",icon:"el-icon-top"},on:{click:function(t){return e.onSort(0)}}},[e._v("升序")]),t("el-button",{attrs:{size:"small",icon:"el-icon-bottom"},on:{click:function(t){return e.onSort(1)}}},[e._v("降序")])],1):e._e(),t("el-input",{staticClass:"global-element-input",attrs:{type:"text",placeholder:e.placeholder},model:{value:e.textValue,callback:function(t){e.textValue=t},expression:"textValue"}},[t("el-button",{staticClass:"btn",attrs:{slot:"append"},on:{click:function(t){return e.onSubmit(e.textValue)}},slot:"append"},[e._v("确定")])],1),e.showEmptyCheckbox?t("el-button",{staticStyle:{"margin-top":"14px"},attrs:{size:"small"},on:{click:function(t){return e.onSubmit(-1)}}},[e._v("筛选空值")]):e._e()],1)},x=[],S={data(){return{textValue:""}},props:{value:{type:String|Number},placeholder:{type:String,default:"请输入"},showEmptyCheckbox:{type:Boolean,default:!1},sort:{type:Boolean,default:!1}},watch:{value:{handler:function(e){this.textValue=e},immediate:!0}},methods:{doClose(){this.$parent.doClose()},onSubmit(e){this.$emit("save",e),this.doClose()},onSort(e){this.$emit("sort",e),this.doClose()}}},T=S,E=(0,h.Z)(T,w,x,!1,null,"4fbdd3e4",null),N=E.exports,F=function(){var e=this,t=e._self._c;return t("div",{staticClass:"checkgroup-panel"},[t("div",{staticClass:"checkgroup-list"},[t("el-checkbox-group",{staticClass:"hd-checkgroup",model:{value:e.groupValues,callback:function(t){e.groupValues=t},expression:"groupValues"}},[e._l(e.data,(function(i){return t("el-checkbox",{key:i.id,attrs:{label:i.id},on:{change:e.clearEmptySelect}},[e._v(e._s(i.name))])})),e.showEmptyCheckbox?t("el-checkbox",{key:-1,attrs:{label:-1},on:{change:e.clearOtherSelect}},[e._v("空值")]):e._e()],2)],1),t("div",{staticClass:"bbar-panel"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("确定")])],1)])},P=[],D={data(){return{groupValues:[]}},props:{data:{type:Array,default:()=>[]},value:{type:Array,default:()=>[]},showEmptyCheckbox:{type:Boolean,default:!1}},methods:{onSubmit(){this.$emit("save",this.groupValues),this.doClose()},doClose(){this.$parent.doClose()},clearOtherSelect(e){e&&(this.groupValues=[-1])},clearEmptySelect(){let e=this.groupValues.findIndex((e=>-1==e));~e&&this.groupValues.splice(e,1)}},watch:{value:{handler:function(e){this.groupValues=e},immediate:!0}}},R=D,z=(0,h.Z)(R,F,P,!1,null,"3a154aea",null),O=z.exports,G=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"radio-panel"},[t("el-radio-group",{staticClass:"hd-radio",model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._l(e.data,(function(i){return t("el-radio",{key:i.id,attrs:{label:i.id}},[e._v(e._s(i.name))])})),e.showEmptyCheckbox?t("el-checkbox",{attrs:{label:-1}},[e._v("空值")]):e._e()],2)],1),t("div",{staticClass:"bbar-panel"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("确定")])],1)])},Y=[],I={data(){return{radio:""}},props:{data:{type:Array,default:()=>[]},value:{type:Number},showEmptyCheckbox:{type:Boolean,default:!1}},methods:{onSubmit(){(this.radio||0===this.radio)&&(this.$emit("save",this.radio),this.doClose())},doClose(){this.$parent.doClose()}},watch:{value:{handler:function(e){this.radio=e},immediate:!0}}},M=I,Z=(0,h.Z)(M,G,Y,!1,null,"5b1c93de",null),$=Z.exports,V=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{padding:"6px"}},[t("div",{staticClass:"btn-panel"},[t("el-button",{attrs:{size:"small",icon:"el-icon-top"},on:{click:function(t){return e.onSort(0)}}},[e._v("升序")]),t("el-button",{attrs:{size:"small",icon:"el-icon-bottom"},on:{click:function(t){return e.onSort(1)}}},[e._v("降序")])],1),t("div",{staticClass:"date-panel-cls"},[t("div",{staticClass:"date-box"},[t("span",[e._v("开始时间："),t("span",{staticClass:"date-value"},[e._v(e._s(e.dateBegin?e.dateBegin.format("Y-m-d"):""))])])]),t("div",{staticClass:"date-box"},[t("span",[e._v("结束时间："),t("span",{staticClass:"date-value"},[e._v(e._s(e.dateEnd?e.dateEnd.format("Y-m-d"):""))])])])]),t("div",{staticClass:"date-panel-cls"},[t("DatePanel",{model:{value:e.dateBegin,callback:function(t){e.dateBegin=t},expression:"dateBegin"}}),t("DatePanel",{model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}})],1),e.showEmptyCheckbox?t("div",{staticStyle:{"padding-top":"14px","border-top":"1px solid #eee"}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$emit("save",-1)}}},[e._v("筛选空值")])],1):e._e(),t("div",{staticClass:"bbar-panel"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("确定")]),t("el-button",{attrs:{size:"small"},on:{click:e.doClose}},[e._v("取消")])],1)])},j=[],H=function(){var e=this,t=e._self._c;return t("div",{staticClass:"date-panel"},[t("el-date-panel",{ref:"datePanel",on:{pick:e.pick}})],1)},U=[],W={props:{date:{default:()=>new Date,type:Date},showTime:{default:!1,type:Boolean}},model:{prop:"date",event:"change"},mounted(){this.$refs.datePanel.value=this.date,this.$refs.datePanel.showTime=this.showTime,this.$refs.datePanel.visible=!0},methods:{pick(e){console.log("pick"),console.log(e),this.$refs.datePanel.value=e,this.$refs.datePanel.resetView&&this.$refs.datePanel.resetView(),this.$emit("change",e)}}},q=W,L=(0,h.Z)(q,H,U,!1,null,"05f0565f",null),Q=L.exports,J={data(){return{dateBegin:null,dateEnd:null}},components:{DatePanel:Q},props:{value:{type:Array,default:()=>[]},showEmptyCheckbox:{type:Boolean,default:!1}},watch:{value(e){const t=e[0]||void 0,i=e[1]||void 0;t&&t instanceof Date?this.dateBegin=t:t&&(this.dateBegin=new Date(t)),i&&i instanceof Date?this.dateEnd=i:i&&(this.dateEnd=new Date(i))}},methods:{onSubmit(){if(!this.dateBegin)return this.$message("请选择开始时间");if(!this.dateEnd)return this.$message("请选择结束时间");if(this.dateBegin>this.dateEnd)return this.$message("开始时间不能晚于结束时间");var e=new Date(this.dateEnd);e.setDate(e.getDate()+1),this.$emit("save",{value:{start_time:this.dateBegin.getTime(),end_time:e.getTime()},valueText:this.getValueText(this.dateBegin.format("Y-m-d"),this.dateEnd.format("Y-m-d"))}),this.doClose()},getValueText(e,t){return e&&!t?e+" 以上":!e&&t?t+" 以下":e&&t?e+" 至 "+t:void 0},onSort(e){this.$emit("sort",e),this.doClose()},doClose(){this.$parent.doClose()}}},X=J,K=(0,h.Z)(X,V,j,!1,null,"3c854276",null),ee=K.exports,te=function(){var e=this,t=e._self._c;return t("div",{staticClass:"kd-tree-filter"},[t("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入关键字"},on:{input:e.search},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.searchText,expression:"!searchText"}],staticClass:"checkgroup-list"},[t("el-tree",{attrs:{data:e.data,"node-key":"id","default-expanded-keys":["0"],"expand-on-click-node":!1},on:{"current-change":e.currentChange},scopedSlots:e._u([{key:"default",fn:function({node:i,data:a}){return t("span",{staticClass:"custom-tree-node"},[t("span",{attrs:{title:a.label}},[/^group/.test(a.id)?t("i",{staticClass:"el-icon-folder-opened"}):e._e(),e._v(" "+e._s(a.label))]),t("span",{class:e.checked==a.id?"el-icon-check icon-cls":""})])}}])})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.searchText,expression:"searchText"}]},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"kd-search-panel"},e._l(e.searchResult,(function(i){return t("div",{key:i.id,staticClass:"search-result-item",on:{click:function(t){return e.currentChange(i)}}},[t("div",{staticClass:"result-item-box"},[t("span",{staticClass:"label-name"},[e._v(e._s(i.label))]),t("span",{staticClass:"group-name"},[e._v(e._s(i.groupName))])]),t("span",{class:e.checked==i.id?"el-icon-check icon-cls":""})])})),0)]),t("div",{staticClass:"bbar-panel"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("确定")]),t("el-button",{attrs:{size:"small"},on:{click:e.doClose}},[e._v("取消")])],1)],1)},ie=[],ae={data(){return{checked:"",searchText:"",loading:!0,searchResult:[],data:[]}},props:{value:{type:Number|String}},mounted(){setTimeout((()=>{let e=[{id:25,text:"158****0001",type:0,pingyin:"158****0001",hasPermit:!0},{id:26,text:"15800000002",type:0,pingyin:"15800000002",hasPermit:!0},{id:27,text:"15800000003",type:0,pingyin:"15800000003",hasPermit:!0},{id:28,text:"15800000004",type:0,pingyin:"15800000004",hasPermit:!0},{id:29,text:"15800000005",type:0,pingyin:"15800000005",hasPermit:!0},{id:30,text:"15800000006",type:0,pingyin:"15800000006",hasPermit:!0},{id:31,text:"15800000007",type:0,pingyin:"15800000007",hasPermit:!0},{id:32,text:"15800000008",type:0,pingyin:"15800000008",hasPermit:!0},{id:33,text:"15800000009",type:0,pingyin:"15800000009",hasPermit:!0},{id:34,text:"15800000010",type:0,pingyin:"15800000010",hasPermit:!0},{id:35,text:"15800000011",type:0,pingyin:"15800000011",hasPermit:!0},{id:36,text:"15800000012",type:0,pingyin:"15800000012",hasPermit:!0},{id:37,text:"15800000013",type:0,pingyin:"15800000013",hasPermit:!0},{id:38,text:"15800000014",type:0,pingyin:"15800000014",hasPermit:!0},{id:39,text:"15800000015",type:0,pingyin:"15800000015",hasPermit:!0},{id:40,text:"15800000016",type:0,pingyin:"15800000016",hasPermit:!0},{id:41,text:"15800000017",type:0,pingyin:"15800000017",hasPermit:!0},{id:42,text:"15800000018",type:0,pingyin:"15800000018",hasPermit:!0},{id:43,text:"15800000019",type:0,pingyin:"15800000019",hasPermit:!0},{id:44,text:"15800000020",type:0,pingyin:"15800000020",hasPermit:!0},{id:45,text:"15800000021",type:0,pingyin:"15800000021",hasPermit:!0}];const t=e=>e.map((e=>({label:e.text,id:e.id,children:e.children?.length?t(e.children):void 0})));this.data=t(e)}),2e3)},methods:{onSubmit(){this.searchText="",this.searchResult=[],this.$emit("save",this.deepGetObj(this.checked,this.data)),this.doClose()},deepGetObj(e,t){for(let i of t){if(i.id==e)return i;if(i.children?.length){const t=this.deepGetObj(e,i.children);if(t)return t}}return!1},currentChange(e){this.checked=e.id},search:(0,d.debounce)((function(){if(this.loading=!0,!this.searchText)return void(this.searchResult=[]);let e=new RegExp(this.searchText);const t=(i,a)=>{let s=[];return i.forEach((i=>{if(!/^group/.test(i.id)&&i.label.match(e)&&s.push({...i,groupName:a}),i.children?.length){const e=t(i.children,i.label);e.length&&s.push(...e)}})),s};this.searchResult=t(this.data,""),this.loading=!1}),400),doClose(){this.$parent.doClose()}},watch:{value:{handler:function(e){this.checked=e},immediate:!0}}},se=ae,ne=(0,h.Z)(se,te,ie,!1,null,"342a3a26",null),le=ne.exports;function re(e,t){let i,a=new Date(t);const s={"Y+":a.getFullYear().toString(),"m+":(a.getMonth()+1).toString(),"d+":a.getDate().toString(),"H+":a.getHours().toString(),"M+":a.getMinutes().toString(),"S+":a.getSeconds().toString()};for(let n in s)i=new RegExp("("+n+")").exec(e),i&&(e=e.replace(i[1],1==i[1].length?s[n]:s[n].padStart(i[1].length,"0")));return e}var oe={components:{CommonGrid:m,FilterColumnWin:A},mixins:[l.Z,C],data(){const e=this.$createElement;return{salesProp:[],displaySetting:[],steps:[],exportPermit:!1,managePermit:!1,loading:!0,rowToolBtns:[{name:"编辑",action:"EDIT_SALES",icon:i(1606)},{name:"删除",action:"DELETE_SALE",icon:i(3593)}],allToolBtns:[{name:"删除",action:"DELETE_SALE",icon:i(3593)}],columns:[],tableData:[],total:0,pagination:{limit:50,start:0},fieldNameMap:{1:{prop:"1",width:200,label:"商机名称",minWidth:200,render:(e,t)=>e("el-button",{attrs:{type:"text",size:"small"},on:{click:e=>this.handleClickSale(t.row,e)}},[t.row.scname]),searchable:!0,searchCmp:()=>e(N,{attrs:{value:this.filter.find((e=>"scname"==e.key))?.value},on:{save:e=>{e&&(this.updatehdFilter({key:"scname",label:"商机名称",value:e}),this.updateGrid())}}})},2:{prop:"2",label:"预计成交金额（元）",width:200,render:(e,t)=>e("span",[t.row.scprice]),minWidth:100,searchable:!0,searchCmp:()=>e(N,{attrs:{placeholder:"请输入预计成交金额",value:this.filter.find((e=>"scprice"==e.key))?.value},on:{save:e=>{if(e){if(!~Number(e))return this.$message("只能筛选数字");this.updatehdFilter({key:"scprice",label:"预计成交金额（元）",value:Number(e)}),this.updateGrid()}}}})},3:{prop:"3",width:150,render:(e,t)=>e("el-button",{attrs:{type:"text",size:"small"},on:{click:e=>this.handleClickCustomer(t.row.custmid,e)}},[t.row.custm_name]),searchable:!0,searchCmp:()=>e(N,{attrs:{value:this.filter.find((e=>"custm_name"==e.key))?.value},on:{save:e=>{e&&(this.updatehdFilter({key:"custm_name",label:"客户名称",value:e}),this.updateGrid())}}})},4:{prop:"4",width:150,render:(e,t)=>{if(!t.row.step_info)return e("span");let i=t.row.step_info;return-99==i.scstep?e("span",[i.name]):e("span",[i.name," (",i.percentage,"%)"])},searchable:!0,searchCmp:()=>e(O,{attrs:{data:this.steps,value:this.filter.find((e=>"scsteps"==e.key))?.value},on:{save:e=>{if(!e.length)return this.deletehdFilter("scsteps"),void this.updateGrid();const t=this.steps.filter((t=>e.includes(t.id))).map((e=>e.name)).join("、");this.updatehdFilter({key:"scsteps",label:"销售阶段",value:e,valueText:t}),this.updateGrid()}}})},5:{prop:"5",width:150,render:(e,t)=>e("span",[t.row.scdeadline?re("YYYY-mm-dd HH:MM",t.row.scdeadline):""]),searchable:!0,searchCmp:()=>e(ee,{on:{sort:e=>{this.updatehdFilter({key:"new_stypes",label:"预计成交时间",value:0==e?[6]:[1],valueText:0==e?"升序":"降序",type:3}),this.updateGrid()},save:e=>{const{value:t,valueText:i}=e;this.updatehdFilter({key:"dtime",label:"预计成交时间",value:{begin_time:t.start_time,end_time:t.end_time},valueText:i}),this.updateGrid()}}})},50:{prop:"50",width:150,render:(e,t)=>e("span",{class:"one-line-ellipsis",attrs:{title:t.row.scnote}},[t.row.scnote]),searchable:!0,searchCmp:()=>e(N,{attrs:{value:this.filter.find((e=>"scnote"==e.key))},on:{save:e=>{e&&(this.updatehdFilter({key:"scnote",label:"备注",value:e}),this.updateGrid())}}})},"创建时间":{prop:"创建时间",width:150,render:(e,t)=>e("span",[t.row.create_time?re("YYYY-mm-dd HH:MM",t.row.create_time):""]),searchable:!0,searchCmp:()=>e(ee,{on:{sort:e=>{this.updatehdFilter({key:"new_stypes",label:"创建时间",value:0==e?[12]:[4],valueText:0==e?"升序":"降序",type:3}),this.updateGrid()},save:e=>{const{value:t,valueText:i}=e;this.updatehdFilter({key:"ctime",label:"创建时间",value:{begin_time:t.start_time,end_time:t.end_time},valueText:i}),this.updateGrid()}}})},"跟进人":{prop:"跟进人",width:150,render:(e,t)=>e("span",{class:"one-line-ellipsis",attrs:{title:t.row.followers.map((e=>e.name)).join("、")}},[t.row.followers.map((e=>e.name)).join("、")]),searchable:!0,searchCmp:()=>e(le,{attrs:{value:this.filter.find((e=>"followers"==e.key))?.value},on:{close:()=>close(),save:e=>{if(!e)return;let t=[e.id];this.updatehdFilter({key:"followers",label:"跟进人",value:t,valueText:e.label}),this.updateGrid()}}})},"跟进记录":{prop:"跟进记录",width:150,render:(e,t)=>t.row.talk_cnt?e("el-button",{attrs:{type:"text",size:"small"}},[t.row.talk_cnt," + '次'"]):e("span",{style:"color:#999"},["无"]),searchable:!0,searchCmp:()=>{const t=[{id:1,name:"无"}];return e($,{attrs:{data:t,value:this.filter.find((e=>"no_record"==e.key))?.value||void 0},on:{save:e=>{const t=["无"][e];this.updatehdFilter({key:"no_record",label:"跟进记录",value:e,valueText:t}),this.updateGrid()}}})}},"更新时间":{prop:"更新时间",width:150,render:(e,t)=>e("span",[t.row.modify_time?re("YYYY-mm-dd HH:MM",t.row.modify_time):""]),searchable:!0,searchCmp:()=>e(ee,{on:{sort:e=>{this.updatehdFilter({key:"new_stypes",label:"更新时间",value:0==e?[13]:[2],valueText:0==e?"升序":"降序",type:3}),this.updateGrid()},save:e=>{const{value:t,valueText:i}=e;this.updatehdFilter({key:"mtime",label:"更新时间",value:{begin_time:t.start_time,end_time:t.end_time},valueText:i}),this.updateGrid()}}})}},dialogVisible:!1}},props:{title:String,type:{type:Number,default:0}},mounted(){this.getIsStoreAdmin(),this.getExportPermit(),this.getSettingConfig().then((async()=>{await this.getDisplayConfig(),this.createColumns(),this.getTableData()})),this.getScSteps()},methods:{getSettingConfig(){return new Promise((e=>{setTimeout((()=>{let t={module_type:8,snumber_setting:0,props:[{prop_id:1,prop_name:"商机名称",is_system:1,disable:1,off_on:1,value_type:0,sort_id:1,is_required:1},{prop_id:2,prop_name:"预计成交金额",is_system:1,disable:1,off_on:1,value_type:1,sort_id:11,is_required:1},{prop_id:3,prop_name:"客户名称",is_system:1,disable:1,off_on:1,value_type:0,sort_id:21,is_required:1},{prop_id:4,prop_name:"销售阶段",is_system:1,disable:1,off_on:1,value_type:0,sort_id:31,is_required:1},{prop_id:5,prop_name:"预计成交时间",is_system:1,disable:1,off_on:1,value_type:2,sort_id:41,is_required:1},{prop_id:50,prop_name:"备注",is_system:1,disable:0,off_on:1,value_type:0,sort_id:999999999,is_required:0},{prop_id:51,prop_name:"图片",is_system:1,disable:1,off_on:1,value_type:6,sort_id:1e9,is_required:0},{prop_id:10001,prop_name:"趣味无穷",is_system:0,disable:0,off_on:1,value_type:1,sort_id:10006,is_required:0}],version:3};this.salesProp=t.props.filter((e=>51!=e.prop_id)),e()}),500)}))},getDisplayConfig(){return new Promise((e=>{setTimeout((async()=>{let t=[{id:1,name:"商机名称",check:!0,disable:!0,width:143},{id:2,name:"预计成交金额",check:!0,disable:!1,width:150},{id:3,name:"客户名称",check:!0,disable:!1,width:108},{id:4,name:"销售阶段",check:!0,disable:!1},{id:5,name:"预计成交时间",check:!0,disable:!1},{id:50,name:"备注",check:!0,disable:!1},{id:10001,name:"趣味无穷",check:!0,disable:!1,width:175},{id:"创建时间",name:"创建时间",check:!0,disable:!1,width:200},{id:"跟进人",name:"跟进人",check:!1,disable:!1,width:200},{id:"跟进记录",name:"跟进记录",check:!1,disable:!1,width:200},{id:"更新时间",name:"更新时间",check:!1,disable:!1,width:200}],i=localStorage.getItem("salesDisplayConfig");i?i=JSON.parse(i):localStorage.setItem("salesDisplayConfig",JSON.stringify(t));let a=!1;try{if(!i.length||"number"==typeof i[0]||"string"==typeof i[0])return a=!0,void(i=this.initDisplayConfig());this.salesProp.forEach((({prop_id:e,prop_name:t})=>{~i.findIndex((t=>t.id==e))||(a=!0,i.push({id:e,name:t,check:!1,disable:!1,width:200}))})),i.forEach((({id:e},t)=>{["创建时间","跟进人","跟进记录","更新时间"].includes(e)||~this.salesProp.findIndex((t=>t.prop_id==e))||(a=!0,i.splice(t,1))}))}catch(s){a=!0,i=this.initDisplayConfig()}finally{a&&await this.setDisplayConfig(i),this.displaySetting=i,e()}}),500)}))},setDisplayConfig(e){return new Promise((t=>{setTimeout((()=>{localStorage.setItem("salesDisplayConfig",JSON.stringify(e)),t()}),200)}))},initDisplayConfig(){let e=[];return this.salesProp.forEach((({prop_id:t,prop_name:i})=>{e.push({id:t,name:i,check:!0,disable:1==t})})),e.push({id:"创建时间",name:"创建时间",check:!0,disable:!1,width:200},{id:"跟进人",name:"跟进人",check:!0,disable:!1,width:200},{id:"跟进记录",name:"跟进记录",check:!0,disable:!1,width:200},{id:"更新时间",name:"更新时间",check:!0,disable:!1,width:200}),e},createColumns(){const e=this.$createElement;let t=[];this.displaySetting.forEach(((i,a)=>{if(i.check)if(this.fieldNameMap[i.id])t.push({label:i.name,newLeftFixed:1==i.id||a<2,...this.fieldNameMap[i.id],width:i.width||200});else{let s=this.salesProp.find((e=>e.prop_id==i.id)),n={label:i.name,width:i.width||200,newLeftFixed:a<2,prop:i.id+"",searchable:!0,render:(e,t)=>{let a=t.row.props.find((e=>e.prop_id==i.id));if(!a)return e("span");let s=a.value?JSON.parse(a.value).value:"";return e("span",[s])}};if(s)switch(s.value_type){case 0:case 1:n.searchCmp=()=>e(N,{attrs:{value:this.filter.find((e=>e.key==i.id)),showEmptyCheckbox:!0,placeholder:"搜索"+i.name},on:{save:e=>{if(!e)return;const t="prop"+i.id,a={id:i.id,txt:e};if(-1==e)return this.updatehdFilter({key:t,label:i.name,valueText:"空值",value:i.id,type:2}),void this.updateGrid();this.updatehdFilter({key:t,label:i.name,valueText:e,value:a}),this.updateGrid()}}});break;case 2:case 3:n.searchCmp=()=>e(ee,{attrs:{showEmptyCheckbox:!0},on:{sort:e=>{const t="prop"+i.id,a={id:i.id,pttype:0==e?2:1};this.updatehdFilter({key:t,label:i.name,valueText:0==e?"升序":"降序",value:a,type:3}),this.updateGrid()},save:e=>{if(-1==e)return this.updatehdFilter({key:s,label:i.name,valueText:"空值",value:i.id,type:2}),void this.updateGrid();const{value:t,valueText:a}=e,s="prop"+i.id,n={id:i.id,time:{begin_time:t.start_time,end_time:t.end_time}};this.updatehdFilter({key:s,label:i.name,valueText:a,value:n}),this.updateGrid()}}});break;default:n.searchCmp=()=>e(N,{attrs:{value:this.filter.find((e=>e.key==i.id)),showEmptyCheckbox:!0,placeholder:"搜索"+i.name},on:{save:e=>{if(!e)return;const t="prop"+i.id,a={id:i.id,txt:e};if(-1==e)return this.updatehdFilter({key:t,label:i.name,valueText:"空值",value:i.id,type:2}),void this.updateGrid();this.updatehdFilter({key:t,label:i.name,valueText:e,value:a}),this.updateGrid()}}});break}t.push(n)}})),this.columns=[],this.$nextTick((()=>{this.columns=t}))},handleHeaderDragend(e,t,i,a){let s=this.displaySetting.find((e=>e.id==i.property));s&&(s.width=e,this.setDisplayConfig(this.displaySetting))},getTableData(){let e={count:this.pagination.limit,skip:(this.pagination.start-1>0?this.pagination.start-1:0)*this.pagination.limit,new_cond:{new_stypes:[2]}};return this.type&&(e.pid=1222222),this.filter.length&&this.filter.map((t=>{e.new_cond[t.key]=t.value})),new Promise((e=>{setTimeout((()=>{let t={result:0,scs:[{scid:102,version:1,scname:"新建商机2",scstep:101,scdeadline:16836768e5,scprice:123123,scnote:"",followers:[{pid:25,start_time:1683355878508,name:"158****0001"}],custmid:1,props:[],pictures:[],atts:[],create_time:1683355878508,create_pid:25,modify_time:1683355878508,modify_pid:25,status:0,del_time:0,step_info:{scstep:101,name:"初步沟通",percentage:10},custm_name:"测试客户"},{scid:101,version:1,scname:"测试商机1",scstep:102,scdeadline:16829856e5,scprice:12,scnote:"",followers:[{pid:25,start_time:1683355854869,name:"158****0001"}],custmid:1,props:[],pictures:[],atts:[],create_time:1683355854869,create_pid:25,modify_time:1683355854869,modify_pid:25,status:0,del_time:0,step_info:{scstep:102,name:"方案报价",percentage:50},custm_name:"测试客户"}],end:!0,total:2};this.$refs.commongrid.resetCheck(),this.tableData=t.scs,this.total=t.total||0,this.loading=!1,e()}),500)}))},updateGrid(){this.loading=!0,this.pagination.start=0,this.getTableData()},getScSteps(){this.steps=[{id:101,name:"初步沟通 (10%)",percentage:10,realName:"初步沟通"},{id:102,name:"方案报价 (50%)",percentage:50,realName:"方案报价"},{id:103,name:"谈判协商 (80%)",percentage:80,realName:"谈判协商"},{id:5,name:"赢单 (100%)",percentage:100,realName:"赢单"},{id:6,name:"输单 (0%)",percentage:0,realName:"输单"},{id:-99,name:"无效",percentage:1,realName:"无效"}]},getExportPermit(){this.exportPermit=1},getIsStoreAdmin(e=15){this.managePermit=!0},openFilterColumnsWin(){this.dialogVisible=!0},async onFliterSave(e){this.loading=!0,this.dialogVisible=!1,this.displaySetting=[...e],await this.setDisplayConfig(this.displaySetting),this.createColumns(),setTimeout((()=>{this.loading=!1}),200)},translateData:function(e){var t={...e,scname:e.scname,scid:e.scid,custmid:{name:e.custm_name,id:e.custmid},scprice:e.scprice,scdeadline:new Date(e.scdeadline),scstepid:{id:e.step_info.scstep},remark:e.scnote,followers:e.followers.map((e=>({id:e.pid,realname:e.name}))),props:e.props,atts:e.atts,pictures:e.pictures};return t},createExportSales(){return new B.sales.win.Export({permission:SF.invoke("sysInfo","super")||this.isAllowedExportBtn?"admin":null})},exportSales(){const e=this.getWin("exportSales");e.show()},getnewcond(){let e={new_stypes:[2]};return this.filter.length&&this.filter.map((t=>{e[t.key]=t.value})),e},async doDeleteSales(e,t,i){console.log("删除全部")},deleSales(e,t){console.log(111)},handleClickSale(e){this.showSale(e,this.salesProp)},handleClickCustomer(e){this.showCustomer(e)},refresh(e){this.getTableData()}},watch:{pagination:{handler:(0,d.debounce)((function(){this.loading=!0,this.getTableData()}),200),deep:!0}}},de=oe,ce=(0,h.Z)(de,s,n,!1,null,"48455aec",null),ue=ce.exports,he=i(3288),pe=i.n(he),me=i(9462),fe=i(4929),ve=i(1306);window.ElUI={ui:pe(),utils:{addResizeListener:me.k,removeResizeListener:me.S,PopupManager:ve.PopupManager,Emitter:fe.Z}},i(3382),a["default"].config.productionTip=!1,a["default"].use(pe()),new a["default"]({render:e=>e(ue)}).$mount("#app")},1606:function(e){"use strict";e.exports="data:image/png;base64,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"},3593:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgEAYAAAAj6qa3AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAZ9JREFUaN7tmD9rwlAUxc8zUgcV7ORiwaVd6yLtB9DFSbJIh+JSMFm6GEHoIB26lGyCWQpuClIUQQoOog7dxH4GwaEIwX8ZXCSd7GAp5LW+vtDkNya57917crjJfYCLsyGsN5BlWVYU0/xpvKZpmqoSZnl6WAtgd6iV/e0bZQ2tYxzvABenQ90DpJk0UwqGQUqkBNPv513AJwsscGcYWl2rq8fBoNUw6h5gu8J3hBDCQyBAG+b4Jug91EKsf1j2OdTn2PEOcAVgvcHOqlYtS/u87QWwO64AvBPgjSsA7wR44wrAOwHeuALwToA3BxuGvoN2SPrrocrxDqAXIIss3tfr/cuyJEtKJ5FgnXBukpvkhWTyy40YYnhbLmnXoz8WF2WxcNRqIYyweZtOsy7YciFVUsV5o1HZVDbqdSZjNY7eAR10SLRYBAC8zOe8C8cYYzzputAUmp6LfJ42XKANGG1H21dd1+PdePfyuVZDDz1cRSIYYkhOT04QRRRjn49ZwQMMcLNakT7pY9tuezWv5rkXxXKqnHo8m06Z7evyT/kAxy6HpJQ1p5IAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDctMjFUMTA6NTA6MTArMDg6MDD34EAqAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA3LTIxVDEwOjUwOjEwKzA4OjAwhr34lgAAAEt0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vaG9tZS9hZG1pbi9pY29uLWZvbnQvdG1wL2ljb25fN2lra2hjNXpqbWEvc2hhbmNodTEuc3ZnJkaMSgAAAABJRU5ErkJggg=="}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=e,function(){var e=[];i.O=function(t,a,s,n){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],s=e[c][1],n=e[c][2];for(var r=!0,o=0;o<a.length;o++)(!1&n||l>=n)&&Object.keys(i.O).every((function(e){return i.O[e](a[o])}))?a.splice(o--,1):(r=!1,n<l&&(l=n));if(r){e.splice(c--,1);var d=s();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,s,n]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,n,l=a[0],r=a[1],o=a[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(s in r)i.o(r,s)&&(i.m[s]=r[s]);if(o)var c=o(i)}for(t&&t(a);d<l.length;d++)n=l[d],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(c)},a=self["webpackChunktable_demo"]=self["webpackChunktable_demo"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=i.O(void 0,[998],(function(){return i(722)}));a=i.O(a)})();